<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>BMECom - Discussion Forum Test</title>
    <link rel="stylesheet" href="styles.css?v=1.9">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <style>
        .test-container {
            padding: 120px 0 80px;
            background: #f0f9ff;
            min-height: 100vh;
        }
        
        .test-section {
            background: white;
            padding: 2rem;
            border-radius: 12px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.05);
            margin-bottom: 2rem;
        }
        
        .test-title {
            font-size: 1.5rem;
            font-weight: 600;
            color: #1f2937;
            margin-bottom: 1rem;
            border-bottom: 2px solid #2563eb;
            padding-bottom: 0.5rem;
        }
        
        .test-button {
            padding: 0.75rem 1.5rem;
            background: #2563eb;
            color: white;
            border: none;
            border-radius: 8px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            margin: 0.5rem;
        }
        
        .test-button:hover {
            background: #1d4ed8;
        }
        
        .test-button.secondary {
            background: #6b7280;
        }
        
        .test-button.secondary:hover {
            background: #4b5563;
        }
        
        .test-button.danger {
            background: #ef4444;
        }
        
        .test-button.danger:hover {
            background: #dc2626;
        }
        
        .test-output {
            background: #f9fafb;
            border: 1px solid #e5e7eb;
            border-radius: 8px;
            padding: 1rem;
            margin: 1rem 0;
            font-family: monospace;
            white-space: pre-wrap;
            max-height: 300px;
            overflow-y: auto;
        }
        
        .status-indicator {
            display: inline-block;
            width: 12px;
            height: 12px;
            border-radius: 50%;
            margin-right: 0.5rem;
        }
        
        .status-success {
            background: #10b981;
        }
        
        .status-error {
            background: #ef4444;
        }
        
        .status-warning {
            background: #f59e0b;
        }
        
        .status-info {
            background: #3b82f6;
        }
        
        .debug-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 1rem;
            margin: 1rem 0;
        }
        
        .debug-item {
            background: #f3f4f6;
            padding: 1rem;
            border-radius: 8px;
            border-left: 4px solid #2563eb;
        }
        
        .debug-label {
            font-weight: 600;
            color: #1f2937;
            margin-bottom: 0.5rem;
        }
        
        .debug-value {
            color: #6b7280;
            font-family: monospace;
        }
        
        .conversation-bubble {
            position: fixed;
            bottom: 30px;
            right: 30px;
            width: 60px;
            height: 60px;
            background: #2563eb;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            box-shadow: 0 4px 12px rgba(37, 99, 235, 0.3);
            transition: all 0.3s ease;
            z-index: 1000;
        }
        
        .conversation-bubble:hover {
            transform: scale(1.1);
            box-shadow: 0 6px 16px rgba(37, 99, 235, 0.4);
        }
        
        .conversation-bubble.expanded {
            width: 400px;
            height: auto;
            border-radius: 12px;
            padding: 1.5rem;
        }
        
        .conversation-bubble.invalid {
            animation: shake 0.5s ease-in-out;
            background: #ef4444;
            box-shadow: 0 0 10px rgba(239, 68, 68, 0.5);
        }
        
        .plus-sign {
            font-size: 2rem;
            color: white;
            font-weight: bold;
        }
        
        @keyframes shake {
            0%, 100% { transform: translateX(0); }
            25% { transform: translateX(-5px); }
            75% { transform: translateX(5px); }
        }
        
        .new-conversation-form {
            display: flex;
            flex-direction: column;
            gap: 1rem;
        }
        
        .form-group {
            display: flex;
            flex-direction: column;
            gap: 0.5rem;
        }
        
        .form-group label {
            font-weight: 600;
            color: white;
        }
        
        .topic-selection {
            display: flex;
            gap: 0.5rem;
            flex-wrap: wrap;
        }
        
        .topic-option {
            display: flex;
            align-items: center;
            gap: 0.25rem;
            padding: 0.5rem;
            border: 1px solid rgba(255, 255, 255, 0.3);
            border-radius: 6px;
            cursor: pointer;
            transition: all 0.3s ease;
            background: rgba(255, 255, 255, 0.1);
            color: white;
            font-size: 0.875rem;
        }
        
        .topic-option:hover {
            border-color: white;
            background: rgba(255, 255, 255, 0.2);
        }
        
        .topic-option.selected {
            border-color: white;
            background: rgba(255, 255, 255, 0.3);
        }
        
        .conversation-name-input {
            width: 100%;
            padding: 8px 12px;
            border: 1px solid rgba(255, 255, 255, 0.3);
            border-radius: 6px;
            font-size: 0.875rem;
            background: rgba(255, 255, 255, 0.1);
            color: white;
            font-family: inherit;
        }
        
        .conversation-name-input::placeholder {
            color: rgba(255, 255, 255, 0.7);
        }
        
        .conversation-name-input:focus {
            outline: none;
            border-color: white;
        }
        
        .create-conversation-btn {
            padding: 8px 16px;
            background: white;
            color: #2563eb;
            border: none;
            border-radius: 6px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            align-self: flex-start;
            font-size: 0.875rem;
        }
        
        .create-conversation-btn:hover {
            background: #f3f4f6;
        }
    </style>
</head>
<body>
    <header class="header">
        <nav class="nav">
            <div class="nav-container">
                <div class="nav-logo">
                    <h2>BMECom - Discussion Test</h2>
                </div>
                <ul class="nav-menu">
                    <li><a href="index.html" class="nav-link">Home</a></li>
                    <li><a href="articles.html" class="nav-link">Articles</a></li>
                    <li><a href="discussion.html" class="nav-link">Discussion</a></li>
                    <li><a href="login.html" class="nav-link" id="loginLink">Login</a></li>
                </ul>
            </div>
        </nav>
    </header>

    <main>
        <section class="test-container">
            <div class="container">
                <div class="test-section">
                    <h1 class="test-title">üîß Discussion Forum Test Page</h1>
                    <p>This page helps debug the discussion forum functionality, bubble visibility, and localStorage issues.</p>
                </div>

                <!-- Authentication Test Section -->
                <div class="test-section">
                    <h2 class="test-title">üîê Authentication Testing</h2>
                    <div>
                        <button class="test-button" onclick="createTestUser()">Create Test User</button>
                        <button class="test-button" onclick="loginTestUser()">Login Test User</button>
                        <button class="test-button secondary" onclick="logoutUser()">Logout</button>
                        <button class="test-button" onclick="checkAuthStatus()">Check Auth Status</button>
                    </div>
                    <div id="authOutput" class="test-output">Authentication status will appear here...</div>
                </div>

                <!-- Bubble Visibility Test Section -->
                <div class="test-section">
                    <h2 class="test-title">üéà Bubble Visibility Testing</h2>
                    <div>
                        <button class="test-button" onclick="showBubble()">Show Bubble</button>
                        <button class="test-button" onclick="hideBubble()">Hide Bubble</button>
                        <button class="test-button" onclick="expandBubble()">Expand Bubble</button>
                        <button class="test-button" onclick="collapseBubble()">Collapse Bubble</button>
                        <button class="test-button" onclick="toggleBubble()">Toggle Bubble</button>
                        <button class="test-button" onclick="checkBubbleState()">Check Bubble State</button>
                    </div>
                    <div id="bubbleOutput" class="test-output">Bubble state will appear here...</div>
                </div>

                <!-- Function Test Section -->
                <div class="test-section">
                    <h2 class="test-title">‚öôÔ∏è Function Testing</h2>
                    <div>
                        <button class="test-button" onclick="testHandleStartConversationClick()">Test handleStartConversationClick</button>
                        <button class="test-button" onclick="testToggleConversationBubble()">Test toggleConversationBubble</button>
                        <button class="test-button" onclick="testCheckAuthStatus()">Test checkAuthStatus</button>
                        <button class="test-button" onclick="testLoadData()">Test loadData</button>
                        <button class="test-button" onclick="testSaveData()">Test saveData</button>
                    </div>
                    <div id="functionOutput" class="test-output">Function test results will appear here...</div>
                </div>

                <!-- localStorage Test Section -->
                <div class="test-section">
                    <h2 class="test-title">üíæ localStorage Testing</h2>
                    <div>
                        <button class="test-button" onclick="checkLocalStorage()">Check localStorage</button>
                        <button class="test-button" onclick="clearLocalStorage()">Clear localStorage</button>
                        <button class="test-button" onclick="createTestConversation()">Create Test Conversation</button>
                        <button class="test-button" onclick="createTestMessage()">Create Test Message</button>
                        <button class="test-button danger" onclick="resetAllData()">Reset All Data</button>
                    </div>
                    <div id="storageOutput" class="test-output">localStorage status will appear here...</div>
                </div>

                <!-- Debug Information Section -->
                <div class="test-section">
                    <h2 class="test-title">üêõ Debug Information</h2>
                    <div class="debug-grid">
                        <div class="debug-item">
                            <div class="debug-label">Current User:</div>
                            <div class="debug-value" id="debugCurrentUser">Not loaded</div>
                        </div>
                        <div class="debug-item">
                            <div class="debug-label">Bubble Element:</div>
                            <div class="debug-value" id="debugBubbleElement">Not found</div>
                        </div>
                        <div class="debug-item">
                            <div class="debug-label">Conversations Count:</div>
                            <div class="debug-value" id="debugConversationsCount">0</div>
                        </div>
                        <div class="debug-item">
                            <div class="debug-label">Messages Count:</div>
                            <div class="debug-value" id="debugMessagesCount">0</div>
                        </div>
                    </div>
                    <button class="test-button" onclick="refreshDebugInfo()">Refresh Debug Info</button>
                </div>

                <!-- Floating Conversation Bubble (for testing) -->
                <div id="conversationBubble" class="conversation-bubble" style="display: none;" onclick="toggleConversationBubble()">
                    <div id="plusSign" class="plus-sign">+</div>
                    <div id="newConversationFormBubble" class="new-conversation-form" style="display: none;">
                        <h3 style="margin-bottom: 1rem; color: white; font-size: 1.1rem;">New Conversation</h3>
                        <div class="form-group">
                            <label style="color: white;">Select Topics:</label>
                            <div class="topic-selection">
                                <label class="topic-option">
                                    <input type="checkbox" name="topics" value="A">
                                    <span>Topic A</span>
                                </label>
                                <label class="topic-option">
                                    <input type="checkbox" name="topics" value="B">
                                    <span>Topic B</span>
                                </label>
                                <label class="topic-option">
                                    <input type="checkbox" name="topics" value="C">
                                    <span>Topic C</span>
                                </label>
                            </div>
                        </div>
                        <div class="form-group">
                            <label for="conversationNameBubble" style="color: white;">Name:</label>
                            <input type="text" id="conversationNameBubble" class="conversation-name-input" placeholder="Enter conversation name" required>
                        </div>
                        <button type="button" class="create-conversation-btn" onclick="handleCreateConversationFromBubble()">
                            Create
                        </button>
                    </div>
                </div>

                <div id="messageContainer"></div>
            </div>
        </section>
    </main>

    <script src="auth.js"></script>
    <script>
        // Test page specific variables
        let conversations = [];
        let conversationMessages = {};

        // Initialize test page
        document.addEventListener('DOMContentLoaded', function() {
            loadData();
            refreshDebugInfo();
            updateOutput('authOutput', 'Test page loaded. Ready for testing.');
        });

        // Authentication Testing Functions
        function createTestUser() {
            const testUser = {
                name: 'TestUser',
                email: 'test@example.com',
                password: 'test123',
                role: 'user'
            };
            
            const users = JSON.parse(localStorage.getItem('users') || '[]');
            users.push(testUser);
            localStorage.setItem('users', JSON.stringify(users));
            
            updateOutput('authOutput', `‚úÖ Test user created: ${testUser.name}\nUsers in localStorage: ${users.length}`);
        }

        function loginTestUser() {
            const users = JSON.parse(localStorage.getItem('users') || '[]');
            const testUser = users.find(u => u.name === 'TestUser');
            
            if (testUser) {
                localStorage.setItem('currentUser', JSON.stringify(testUser));
                updateOutput('authOutput', `‚úÖ Logged in as: ${testUser.name}`);
                refreshDebugInfo();
            } else {
                updateOutput('authOutput', '‚ùå Test user not found. Create one first.');
            }
        }

        function logoutUser() {
            localStorage.removeItem('currentUser');
            updateOutput('authOutput', '‚úÖ Logged out successfully');
            refreshDebugInfo();
        }

        function checkAuthStatus() {
            const currentUser = getCurrentUser();
            const status = currentUser ? `‚úÖ Logged in as: ${currentUser.name}` : '‚ùå Not logged in';
            updateOutput('authOutput', `Auth Status: ${status}`);
        }

        // Bubble Testing Functions
        function showBubble() {
            const bubble = document.getElementById('conversationBubble');
            if (bubble) {
                bubble.style.display = 'flex';
                updateOutput('bubbleOutput', '‚úÖ Bubble shown');
            } else {
                updateOutput('bubbleOutput', '‚ùå Bubble element not found');
            }
        }

        function hideBubble() {
            const bubble = document.getElementById('conversationBubble');
            if (bubble) {
                bubble.style.display = 'none';
                updateOutput('bubbleOutput', '‚úÖ Bubble hidden');
            } else {
                updateOutput('bubbleOutput', '‚ùå Bubble element not found');
            }
        }

        function expandBubble() {
            const bubble = document.getElementById('conversationBubble');
            const form = document.getElementById('newConversationFormBubble');
            const plusSign = document.getElementById('plusSign');
            
            if (bubble && form && plusSign) {
                bubble.classList.add('expanded');
                form.style.display = 'flex';
                plusSign.style.display = 'none';
                updateOutput('bubbleOutput', '‚úÖ Bubble expanded');
            } else {
                updateOutput('bubbleOutput', '‚ùå Bubble elements not found');
            }
        }

        function collapseBubble() {
            const bubble = document.getElementById('conversationBubble');
            const form = document.getElementById('newConversationFormBubble');
            const plusSign = document.getElementById('plusSign');
            
            if (bubble && form && plusSign) {
                bubble.classList.remove('expanded');
                form.style.display = 'none';
                plusSign.style.display = 'block';
                updateOutput('bubbleOutput', '‚úÖ Bubble collapsed');
            } else {
                updateOutput('bubbleOutput', '‚ùå Bubble elements not found');
            }
        }

        function toggleBubble() {
            const bubble = document.getElementById('conversationBubble');
            if (bubble) {
                if (bubble.classList.contains('expanded')) {
                    collapseBubble();
                } else {
                    expandBubble();
                }
            } else {
                updateOutput('bubbleOutput', '‚ùå Bubble element not found');
            }
        }

        function checkBubbleState() {
            const bubble = document.getElementById('conversationBubble');
            if (bubble) {
                const isVisible = bubble.style.display !== 'none';
                const isExpanded = bubble.classList.contains('expanded');
                const form = document.getElementById('newConversationFormBubble');
                const plusSign = document.getElementById('plusSign');
                
                const formVisible = form ? form.style.display !== 'none' : 'N/A';
                const plusVisible = plusSign ? plusSign.style.display !== 'none' : 'N/A';
                
                updateOutput('bubbleOutput', 
                    `Bubble State:\n` +
                    `- Visible: ${isVisible}\n` +
                    `- Expanded: ${isExpanded}\n` +
                    `- Form visible: ${formVisible}\n` +
                    `- Plus sign visible: ${plusVisible}`
                );
            } else {
                updateOutput('bubbleOutput', '‚ùå Bubble element not found');
            }
        }

        // Function Testing
        function testHandleStartConversationClick() {
            try {
                if (typeof handleStartConversationClick === 'function') {
                    handleStartConversationClick();
                    updateOutput('functionOutput', '‚úÖ handleStartConversationClick executed');
                } else {
                    updateOutput('functionOutput', '‚ùå handleStartConversationClick function not found');
                }
            } catch (error) {
                updateOutput('functionOutput', `‚ùå Error: ${error.message}`);
            }
        }

        function testToggleConversationBubble() {
            try {
                if (typeof toggleConversationBubble === 'function') {
                    toggleConversationBubble();
                    updateOutput('functionOutput', '‚úÖ toggleConversationBubble executed');
                } else {
                    updateOutput('functionOutput', '‚ùå toggleConversationBubble function not found');
                }
            } catch (error) {
                updateOutput('functionOutput', `‚ùå Error: ${error.message}`);
            }
        }

        function testCheckAuthStatus() {
            try {
                if (typeof checkAuthStatus === 'function') {
                    checkAuthStatus();
                    updateOutput('functionOutput', '‚úÖ checkAuthStatus executed');
                } else {
                    updateOutput('functionOutput', '‚ùå checkAuthStatus function not found');
                }
            } catch (error) {
                updateOutput('functionOutput', `‚ùå Error: ${error.message}`);
            }
        }

        function testLoadData() {
            try {
                if (typeof loadData === 'function') {
                    loadData();
                    updateOutput('functionOutput', '‚úÖ loadData executed');
                } else {
                    updateOutput('functionOutput', '‚ùå loadData function not found');
                }
            } catch (error) {
                updateOutput('functionOutput', `‚ùå Error: ${error.message}`);
            }
        }

        function testSaveData() {
            try {
                if (typeof saveData === 'function') {
                    saveData();
                    updateOutput('functionOutput', '‚úÖ saveData executed');
                } else {
                    updateOutput('functionOutput', '‚ùå saveData function not found');
                }
            } catch (error) {
                updateOutput('functionOutput', `‚ùå Error: ${error.message}`);
            }
        }

        // localStorage Testing
        function checkLocalStorage() {
            const conversationsData = localStorage.getItem('conversations');
            const messagesData = localStorage.getItem('conversationMessages');
            const currentUser = localStorage.getItem('currentUser');
            const users = localStorage.getItem('users');
            
            updateOutput('storageOutput', 
                `localStorage Status:\n` +
                `- Conversations: ${conversationsData ? 'Found' : 'Not found'}\n` +
                `- Messages: ${messagesData ? 'Found' : 'Not found'}\n` +
                `- Current User: ${currentUser ? 'Found' : 'Not found'}\n` +
                `- Users: ${users ? 'Found' : 'Not found'}\n\n` +
                `Raw Data:\n` +
                `Conversations: ${conversationsData || 'null'}\n` +
                `Messages: ${messagesData || 'null'}`
            );
        }

        function clearLocalStorage() {
            localStorage.removeItem('conversations');
            localStorage.removeItem('conversationMessages');
            updateOutput('storageOutput', '‚úÖ localStorage cleared for conversations and messages');
            refreshDebugInfo();
        }

        function createTestConversation() {
            const currentUser = getCurrentUser();
            if (!currentUser) {
                updateOutput('storageOutput', '‚ùå Please login first');
                return;
            }

            const testConversation = {
                id: Date.now().toString(),
                name: 'Test Conversation',
                topics: ['A', 'B'],
                author: currentUser.name,
                timestamp: new Date().toISOString(),
                messageCount: 0
            };

            conversations.push(testConversation);
            conversationMessages[testConversation.id] = [];
            saveData();
            
            updateOutput('storageOutput', `‚úÖ Test conversation created: ${testConversation.name}`);
            refreshDebugInfo();
        }

        function createTestMessage() {
            const currentUser = getCurrentUser();
            if (!currentUser) {
                updateOutput('storageOutput', '‚ùå Please login first');
                return;
            }

            if (conversations.length === 0) {
                updateOutput('storageOutput', '‚ùå No conversations found. Create one first.');
                return;
            }

            const conversationId = conversations[0].id;
            const testMessage = {
                id: Date.now().toString(),
                content: 'This is a test message',
                author: currentUser.name,
                timestamp: new Date().toISOString(),
                likes: [],
                dislikes: [],
                replies: []
            };

            if (!conversationMessages[conversationId]) {
                conversationMessages[conversationId] = [];
            }
            conversationMessages[conversationId].push(testMessage);
            saveData();
            
            updateOutput('storageOutput', `‚úÖ Test message created in conversation: ${conversations[0].name}`);
            refreshDebugInfo();
        }

        function resetAllData() {
            localStorage.clear();
            conversations = [];
            conversationMessages = {};
            updateOutput('storageOutput', '‚úÖ All data reset');
            refreshDebugInfo();
        }

        // Utility Functions
        function loadData() {
            try {
                const conversationsData = localStorage.getItem('conversations');
                if (conversationsData) {
                    conversations = JSON.parse(conversationsData);
                }

                const messagesData = localStorage.getItem('conversationMessages');
                if (messagesData) {
                    conversationMessages = JSON.parse(messagesData);
                }
            } catch (error) {
                console.error('Error loading data:', error);
                conversations = [];
                conversationMessages = {};
            }
        }

        function saveData() {
            try {
                localStorage.setItem('conversations', JSON.stringify(conversations));
                localStorage.setItem('conversationMessages', JSON.stringify(conversationMessages));
            } catch (error) {
                console.error('Error saving data:', error);
            }
        }

        function refreshDebugInfo() {
            const currentUser = getCurrentUser();
            const bubble = document.getElementById('conversationBubble');
            
            document.getElementById('debugCurrentUser').textContent = 
                currentUser ? currentUser.name : 'Not logged in';
            document.getElementById('debugBubbleElement').textContent = 
                bubble ? 'Found' : 'Not found';
            document.getElementById('debugConversationsCount').textContent = 
                conversations.length;
            document.getElementById('debugMessagesCount').textContent = 
                Object.keys(conversationMessages).length;
        }

        function updateOutput(elementId, message) {
            const element = document.getElementById(elementId);
            if (element) {
                element.textContent = `${new Date().toLocaleTimeString()}: ${message}`;
            }
        }

        // Import functions from discussion.js if they exist
        function handleCreateConversationFromBubble() {
            const currentUser = getCurrentUser();
            if (!currentUser) {
                updateOutput('functionOutput', '‚ùå User not logged in');
                return;
            }
            
            const selectedTopics = Array.from(document.querySelectorAll('#conversationBubble input[name="topics"]:checked'))
                .map(checkbox => checkbox.value);

            if (selectedTopics.length === 0) {
                updateOutput('functionOutput', '‚ùå Please select at least one topic');
                return;
            }

            const conversationName = document.getElementById('conversationNameBubble').value.trim();
            if (!conversationName) {
                updateOutput('functionOutput', '‚ùå Please enter a conversation name');
                return;
            }

            const newConversation = {
                id: Date.now().toString(),
                name: conversationName,
                topics: selectedTopics,
                author: currentUser.name,
                timestamp: new Date().toISOString(),
                messageCount: 0
            };

            conversations.unshift(newConversation);
            conversationMessages[newConversation.id] = [];
            saveData();

            // Reset form
            document.getElementById('conversationNameBubble').value = '';
            document.querySelectorAll('#conversationBubble input[name="topics"]').forEach(checkbox => {
                checkbox.checked = false;
            });

            updateOutput('functionOutput', `‚úÖ Conversation created: ${conversationName}`);
            refreshDebugInfo();
        }

        function toggleConversationBubble() {
            const bubble = document.getElementById('conversationBubble');
            const form = document.getElementById('newConversationFormBubble');
            const plusSign = document.getElementById('plusSign');
            
            if (bubble && form && plusSign) {
                if (bubble.classList.contains('expanded')) {
                    bubble.classList.remove('expanded');
                    form.style.display = 'none';
                    plusSign.style.display = 'block';
                } else {
                    bubble.classList.add('expanded');
                    form.style.display = 'flex';
                    plusSign.style.display = 'none';
                }
            }
        }

        function handleStartConversationClick() {
            const currentUser = getCurrentUser();
            if (!currentUser) {
                updateOutput('functionOutput', '‚ùå User not logged in');
                return;
            }
            
            const conversationBubble = document.getElementById('conversationBubble');
            if (conversationBubble) {
                conversationBubble.style.display = 'flex';
                conversationBubble.classList.add('expanded');
                const form = document.getElementById('newConversationFormBubble');
                const plusSign = document.getElementById('plusSign');
                if (form) form.style.display = 'flex';
                if (plusSign) plusSign.style.display = 'none';
            }
        }

        function checkAuthStatus() {
            const currentUser = getCurrentUser();
            const conversationBubble = document.getElementById('conversationBubble');
            
            if (currentUser) {
                if (conversationBubble) {
                    conversationBubble.style.display = 'flex';
                }
            } else {
                if (conversationBubble) {
                    conversationBubble.style.display = 'none';
                }
            }
        }
    </script>
</body>
</html>

